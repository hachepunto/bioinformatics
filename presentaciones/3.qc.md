# github.com/hachepunto/bioinformatics

# FastQC

FastQC es el programa más utilizado para revisar la calidad de las secuencias de los experimentos de secuenciación masiva.

Liga: https://www.bioinformatics.babraham.ac.uk/projects/fastqc/

Para descargarlo puedes ir a la página de la herramienta [**FastQC**](https://www.bioinformatics.babraham.ac.uk/projects/fastqc/) y hacer click en <b>Download Now</b> y escoges la descarga adecuada para tu sistema operativo Linux/Windows o Mac. 
	
FastQC ya está descargado en Drona pero si quieres instalarlo en tu computadora, además de descargarlo, descomprimirlo y tener java instalado en el sistema. Las instrucciones se encuentran en la liga de descarga. Ahí además están las instrucciones de uso.
	
Hay dos modos de ejecutar FastQC: interactivo y no-interactivo. 
	
El interactivo sólo se puede utilizar si lo tienen instalado en su propia computadora. Por lo que aquí vamos a usarlo de manera no interactiva a través del servidor. La forma no-interactiva es la más común de utilizar porque de esta manera se incluye en los pipelines.
	
Interactivo:

```
fastqc
```

No-interactivo: 

```
fastqc read1 read2
```

Vamos a revisar la sección de la documentación donde se describen las gráficas ([**liga**](https://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/)) y luego los ejemplos de datos de [**mala**](https://www.bioinformatics.babraham.ac.uk/projects/fastqc/bad_sequence_fastqc.html) y [**buena**](https://www.bioinformatics.babraham.ac.uk/projects/fastqc/good_sequence_short_fastqc.html) calidad. 

## Ejercicio:

En tu carpeta datos.taller copia los archivos fastq que vamos a utilizar:

```
cp /home/instalaciones/head_1mill_input_* ~/datos.taller/
```

Muévete a tu carpeta datos.taller:
```
cd datos.taller
```

Crea una carpeta para guardar los resultados de FastQC:
```
mkdir salida_fastqc
```

Ejecuta Fastqc en los archivos que acabas de copiar:
```
fastqc head_1mill_input_forward_R1_001.fastq head_1mill_input_reverse_R2_001.fastq -o salida_fastqc
```

Desde tu computadora (ojo: no desde drona), puedes revisar los reportes html creados por FastQC en la carpeta salida_fastqc usando un navegador.
** Si lograste montar drona en tu computadora entonces vas a encontrar los archivos en ~/mnt/drona/datos.taller/salida_fastqc
** Si no lograste montar drona entonces crea un directorio en tu computadora (en el Escritorio/Desktop) para guardar lo que hagas en este taller y luego copia los datos desde drona:
```
mkdir -p Desktop/datos.taller.local
```
```
cd Desktop/datos.taller.local
```


	
# Trimmomatic

Trimmomatic es un programa para remover adaptadores y bases con baja calidad en nuestras secuencias.

Github: https://github.com/usadellab/Trimmomatic

Trimmomatic ya está en drona, pero si quieres descargarlo en tu computadora estos son los pasos:
```
wget https://github.com/usadellab/Trimmomatic/files/5854859/Trimmomatic-0.39.zip
unzip Trimmomatic-0.39.zip
```

## Ejercicio:

```
trimmomatic=/home/instalaciones/Trimmomatic-0.39/
read=~/datos.taller/head_1mill_input_forward_R1_001.fastq
mate=~/datos.taller/head_1mill_input_reverse_R2_001.fastq
outdir=salida_trimmomatic

mkdir -p ${outdir}

java -jar ${trimmomatic}/trimmomatic-0.39.jar PE \
        $read \
        $mate \
        ${outdir}/read_paired.fq \
        ${outdir}/read_unpaired.fq \
        ${outdir}/mate_paired.fq \
        ${outdir}/mate_unpaired.fq \
        ILLUMINACLIP:${trimmomatic}/adapters/NexteraPE-PE.fa:2:30:10 \
        LEADING:30 \
        TRAILING:30 \
        MINLEN:75 \
        SLIDINGWINDOW:5:20
```

Revisemos con FastQC como se ven ahora las secuencias

```
cd salida_trimmomatic
mkdir salida_fastqc
fastqc read_paired.fq mate_paired.fq -o salida_fastqc
```
De nuevo en tu computadora, revisa los resultados en un navegador y compara con los resultados antes de Trimmomatic.


# Kallisto

Es un programa para la cuantificación de datos de bulk o single-cell RNA-seq

Liga: https://pachterlab.github.io/kallisto/

Primero revisa la sección <b>Getting started</b>

Para poder cuantificar Kallisto necesita un índice del transcriptoma de referencia. Kallisto nos proporciona unos ya generados o podemos generar el nuestro

Liga índices: https://github.com/pachterlab/kallisto-transcriptome-indices/releases

Información de los datos que vamos a usar:

Liga: https://rnabio.org/module-01-inputs/0001/05/01/RNAseq_Data/

## Ejercicio:

```
idx="/home/acerverat/bioinfo101/Kallisto_index/homo_sapiens/transcriptome_chr22.idx"
reads="/home/acerverat/bioinfo101/datos/HBR_Rep1_ERCC-Mix2_Build37-ErccTranscripts-chr22.read1.fastq.gz"
mates="/home/acerverat/bioinfo101/datos/HBR_Rep1_ERCC-Mix2_Build37-ErccTranscripts-chr22.read2.fastq.gz"

kallisto quant -i ${idx} -o salida_kallisto --rf-stranded $reads $mates
```

Para hacer lo mismo ahora varias muestras podemos poner el comando de un bucle o loop:

```
idx="/home/acerverat/bioinfo101/Kallisto_index/homo_sapiens/transcriptome_chr22.idx"

for id in HBR_Rep1 HBR_Rep2 HBR_Rep3
do
  reads="/home/acerverat/bioinfo101/datos/${id}_ERCC-Mix2_Build37-ErccTranscripts-chr22.read1.fastq.gz"
  mates="/home/acerverat/bioinfo101/datos/${id}_ERCC-Mix2_Build37-ErccTranscripts-chr22.read2.fastq.gz"
  
  kallisto quant -i ${idx} -o salida_kallisto_${id} --rf-stranded $reads $mates
done
```
