# github.com/hachepunto/bioinformatics

# Archivos Fastq

Ver presentación [**FastQ**](https://raw.githubusercontent.com/hachepunto/bioinformatics/master/presentaciones/FastQ.pdf)

En tu carpeta datos.taller copia los archivos fastq que vamos a utilizar:

```
cp /home/instalaciones/head_1mill_input_* ~/datos.taller/
```

Muévete a tu carpeta datos.taller:
```
cd ~/datos.taller
```
Despliega las primeraz líneas del archivo fastq.

```
head head_1mill_input_forward_R1_001.fastq
```


# FastQC

FastQC es el programa más utilizado para revisar la calidad de las secuencias de los experimentos de secuenciación masiva.

Liga: https://www.bioinformatics.babraham.ac.uk/projects/fastqc/

Para descargarlo puedes ir a la página de la herramienta [**FastQC**](https://www.bioinformatics.babraham.ac.uk/projects/fastqc/) y hacer click en <b>Download Now</b> y escoges la descarga adecuada para tu sistema operativo Linux/Windows o Mac. 
	
FastQC ya está descargado en Drona pero si quieres instalarlo en tu computadora, además de descargarlo, debes descomprimirlo y tener java instalado en el sistema. Las instrucciones se encuentran en la liga de descarga. Ahí además están las instrucciones de uso.
	
Hay dos modos de ejecutar FastQC: interactivo y no-interactivo. 
	
El interactivo sólo se puede utilizar si lo tienen instalado en su propia computadora. Por lo que aquí vamos a usarlo de manera no interactiva a través del servidor. La forma no-interactiva es la más común de utilizar porque de esta manera se incluye en los pipelines.
	
Interactivo:

```
fastqc
```

No-interactivo: 

```
fastqc read1 read2
```

Vamos a revisar la sección de la documentación donde se describen las gráficas ([**liga**](https://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/)) y luego los ejemplos de datos de [**mala**](https://www.bioinformatics.babraham.ac.uk/projects/fastqc/bad_sequence_fastqc.html) y [**buena**](https://www.bioinformatics.babraham.ac.uk/projects/fastqc/good_sequence_short_fastqc.html) calidad. 

## Ejercicio:

En tu carpeta datos.taller copia los archivos fastq que vamos a utilizar:

```
cp /bodega/curso_intro_bioinfo/data/head_1mill_input_* ~/datos.taller/
```

Muévete a tu carpeta datos.taller:
```
cd ~/datos.taller
```

Crea una carpeta para guardar los resultados de FastQC:
```
mkdir salida_fastqc
```

Ejecuta Fastqc en los archivos que acabas de copiar:
```
fastqc head_1mill_input_forward_R1_001.fastq head_1mill_input_reverse_R2_001.fastq -o salida_fastqc
```

Desde tu computadora (ojo: no desde drona), puedes revisar los reportes html creados por FastQC en la carpeta salida_fastqc usando un navegador.

```
scp -r alumnoX@10.0.15.11:~/datos.taller/salida_fastqc .
```

Ahora en salida_fastqc estan los archivos html que puedes revisar con un navegador. 


	
# Fastp

Fastp es un programa para remover adaptadores y bases con baja calidad en nuestras secuencias.

Github: https://github.com/OpenGene/fastp

Fastp ya está en drona, pero si quieres descargarlo en tu computadora estos son los pasos:

```
# download the latest build
wget http://opengene.org/fastp/fastp
chmod a+x ./fastp

# or download specified version, i.e. fastp v0.23.4
wget http://opengene.org/fastp/fastp.0.23.4
mv fastp.0.23.4 fastp
chmod a+x ./fastp
```

## Ejercicio:

Copia todo el texto de abajo y guárdalo en un archivo fastp.sh dentro en tu datos.taller, esto lo puedes hacer con el bloc de notas, NotePad, gedit, TextEdit, nano, o cualquier otro editor de texto plano.

```
bin=/bodega/curso_intro_bioinfo/bin/
read=~/datos.taller/head_1mill_input_forward_R1_001.fastq
mate=~/datos.taller/head_1mill_input_reverse_R2_001.fastq
outdir=~/datos.taller/salida_fastp

mkdir -p ${outdir}
cd ${outdir}

${bin}/fastp -i ${read} -I ${mate} -o out.R1.fq.gz -O out.R2.fq.gz
```
Si tu archivo lo creaste en tu computadora local, copialo al servidor con el siguiente comando:

```
scp fastp.sh alumnoX@drona.inmegen.gob.mx:~/datos.taller
```

Ejecutemos el script (en drona) que acabamos de crear

```
cd ~/datos.taller
bash fastp.sh
```

Revisemos con FastQC como se ven ahora las secuencias

```
mkdir salida_fastqc_trimmed
fastqc salida_fastp/out.R1.fq.gz salida_fastp/out.R2.fq.gz -o salida_fastqc_trimmed
```
De nuevo en tu computadora, revisa los resultados en un navegador y compara con los resultados antes y después de usar Fastp.




